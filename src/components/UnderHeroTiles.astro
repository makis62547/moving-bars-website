---
const base = (import.meta.env.BASE_URL || "/").replace(/\/?$/, "/");
const asset = (p) => `${base}${p.replace(/^\//, "")}`;

const sliderImagesCocktails = [
  asset("images/cocktail-cosmopolitan.jpg"),
  asset("images/russian-wild-berry-cocktail.jpg"),
  asset("images/placeholder-1.jpg"),
  asset("images/placeholder-2.jpg"),
  asset("images/placeholder-3.jpg"),
  asset("images/placeholder-4.jpg"),
];

const sliderImagesDefault = [
  asset("images/mobile-cocktailbar-mit-rueckbuffet.jpg"),
  asset("images/placeholder-1.jpg"),
  asset("images/placeholder-2.jpg"),
  asset("images/placeholder-3.jpg"),
  asset("images/placeholder-4.jpg"),
];
---

<section class="under-hero-tiles" aria-label="Ergänzende Informationen" data-uh-tiles>
  <div class="tiles-shell">
    <!-- ✅ H2 / INTRO BLOCK: unverändert -->
    <article class="tile tile--intro">
      <div class="intro">
        <div class="intro__icon" aria-hidden="true">
          <svg class="intro__svg" viewBox="0 0 128 128" role="img" aria-label="">
            <g fill="currentColor">
              <circle cx="64" cy="42" r="18" />
              <path d="M34 108c0-18 14-32 30-32s30 14 30 32H34z" />
              <circle cx="30" cy="50" r="14" opacity="0.95" />
              <path d="M8 108c0-14 11-25 24-25s24 11 24 25H8z" opacity="0.95" />
              <circle cx="98" cy="50" r="14" opacity="0.95" />
              <path d="M72 108c0-14 11-25 24-25s24 11 24 25H72z" opacity="0.95" />
            </g>
          </svg>
        </div>

        <div class="intro__sep" aria-hidden="true"></div>

        <div class="intro__copy">
          <h2 class="intro-display display-heading display-size-h1">
            <span class="h2-line1">
              <span class="h2-accent">PRIVATE FEIER</span> – MESSEPARTY –
            </span>
            <br />
            GROSSVERANSTALTUNG
          </h2>

          <p class="intro__paragraph">
            Seit der Gründung im Jahr 2000 ist moving bars Ihr kompetenter Partner im Bereich Cocktail Catering und mobile
            Cocktailbar mieten auf Messen und Events in Berlin, Deutschland und ganz Europa. Vom Sektempfang bis zur
            Cocktailparty mit Showprogramm, bieten wir Ihnen professionelle Lösungen und begeistern mit der liebevollen
            Umsetzung Ihrer Wünsche! Unsere mobile Cocktailbar verwöhnt Sie und Ihre Gäste, damit Sie sich ganz auf Ihre
            Veranstaltung konzentrieren können.
          </p>
        </div>
      </div>
    </article>

    <!-- ✅ NUR das was danach kommt: 2×2 Quadrate, full-bleed -->
    <div class="wide-rows" aria-label="Quadrat-Kacheln">
      <!-- ROW 1: Text | Slider -->
      <div class="wide-row">
        <article class="panel panel--text" aria-label="Feinste Cocktails Text">
          <div class="panel-inner">
            <h3 class="panel-title display-heading display-size-h1">
              <span class="accent">FEINSTE</span> COCKTAILS & LONGDRINKS
            </h3>
            <div class="panel-sep" aria-hidden="true"></div>

            <p class="panel-text">
              Wenn Sie unsere mobile Cocktailbar mieten, mixen wir für Sie und Ihre Gäste klassische und moderne Cocktails
              oder/und Longdrinks aus besten Zutaten. Wir arbeiten mit bekannten Markenspirituosen, hochwertigen
              Fruchtsäften der Marke Bauer Fruchtsaft, Fillern von Thomas Henry und frischen Zutaten, die wir mit
              Sachverstand aussuchen und verarbeiten. Haben Sie genaue Vorstellungen oder einen Lieblingscocktail? Suchen
              Sie einen farblich auf Ihr Firmenlogo abgestimmten CI-Drink? Soll es etwas Besonderes sein, wie molekulare
              Cocktails? Wir helfen Ihnen bei der Auswahl! Sprechen Sie mit uns, wir beraten Sie gerne.
            </p>

            <a class="panel-cta" href="#" aria-label="Cocktail Menüs ansehen">HIER UNSERE COCKTAIL MENUS ANSEHEN</a>
          </div>
        </article>

        <article class="panel panel--slider" aria-label="Feinste Cocktails Slider">
          <div class="slider" data-slider>
            <button class="slider-btn prev" type="button" aria-label="Vorheriges Bild">‹</button>
            <div class="slider-track" tabindex="0" aria-label="Bildergalerie">
              {sliderImagesCocktails.map((src, index) => (
                <div class="slide" aria-label={`Bild ${index + 1}`}>
                  <img class="parallax-img" data-parallax="1" alt="Cocktail" src={src} loading="lazy" decoding="async" />
                </div>
              ))}
            </div>
            <button class="slider-btn next" type="button" aria-label="Nächstes Bild">›</button>
          </div>
        </article>
      </div>

      <!-- ROW 2: Slider | Text -->
      <div class="wide-row">
        <article class="panel panel--slider" aria-label="Mobile Bar Slider">
          <div class="slider" data-slider>
            <button class="slider-btn prev" type="button" aria-label="Vorheriges Bild">‹</button>
            <div class="slider-track" tabindex="0" aria-label="Bildergalerie">
              {sliderImagesDefault.map((src, index) => (
                <div class="slide" aria-label={`Bild ${index + 1}`}>
                  <img class="parallax-img" data-parallax="1" alt="" src={src} loading="lazy" decoding="async" />
                </div>
              ))}
            </div>
            <button class="slider-btn next" type="button" aria-label="Nächstes Bild">›</button>
          </div>
        </article>

        <article class="panel panel--text" aria-label="Mobile Bar Text">
          <div class="panel-inner">
            <h3 class="panel-title display-heading display-size-h1">
              <span class="accent">MOBILE BAR</span> MIETEN IN BERLIN
            </h3>
            <div class="panel-sep" aria-hidden="true"></div>

            <p class="panel-text">
              Unsere mobile Bar ist das Ergebnis aus über 20 Jahren Erfahrung im Bereich Cocktail Catering und mobile
              Cocktailbar mieten in Berlin und üBARall in Deutschland. Das System stellt gleichermaßen beide Seiten
              zufrieden: Den Gast, durch das ansprechende, zeitlose Design und den Event-Profi durch kompromisslose
              Ausstattung und Flexibilität. Durch die unterschiedlichen Beleuchtungs- und Gestaltungsmöglichkeiten passt
              die mobile Bar sich jeder Situation und Umgebung an. Hochwertiger Edelstahl und weißes Acrylglas sorgen für
              ein zeitloses Design. Unsere mobile Bar ist mit moderner LED-RGBW-Technik hinterleuchtet und läßt sich auf
              jeden gewünschten Farbton einstellen.
            </p>

            <a class="panel-cta" href="/anfrage" aria-label="Jetzt anfragen">JETZT ANFRAGEN</a>
          </div>
        </article>
      </div>
    </div>
  </div>
</section>

<script is:inline>
  const onReady = () => {
    // Slider buttons
    document.querySelectorAll("[data-slider]").forEach((slider) => {
      const track = slider.querySelector(".slider-track");
      const prev = slider.querySelector(".slider-btn.prev");
      const next = slider.querySelector(".slider-btn.next");
      if (!track || !prev || !next) return;

      const scrollAmount = () => track.clientWidth;
      prev.addEventListener("click", () => track.scrollBy({ left: -scrollAmount(), behavior: "smooth" }));
      next.addEventListener("click", () => track.scrollBy({ left: scrollAmount(), behavior: "smooth" }));
    });

    // Parallax (stärker)
    const prefersReduced = window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches;
    const els = Array.from(document.querySelectorAll(".parallax-img"));
    if (prefersReduced || !els.length) return;

    let ticking = false;
    const clamp = (v, min, max) => Math.max(min, Math.min(max, v));

    const update = () => {
      ticking = false;
      const vh = window.innerHeight || 1;
      const viewportCenter = vh * 0.5;

      // ✅ deutlich stärker als vorher
      const baseAmp = 160;

      for (const el of els) {
        const r = el.getBoundingClientRect();
        const center = r.top + r.height * 0.5;
        const norm = (center - viewportCenter) / vh; // ca. -1..1
        const speed = parseFloat(el.dataset.parallax || "1") || 1;
        const y = clamp(-norm * baseAmp * speed, -baseAmp * 1.6, baseAmp * 1.6);
        el.style.setProperty("--parallaxY", `${y}px`);
      }
    };

    const tick = () => {
      if (ticking) return;
      ticking = true;
      requestAnimationFrame(update);
    };

    window.addEventListener("scroll", tick, { passive: true });
    window.addEventListener("resize", tick);
    document.querySelectorAll(".slider-track").forEach((t) => t.addEventListener("scroll", tick, { passive: true }));

    tick();
  };

  if (document.readyState === "loading") document.addEventListener("DOMContentLoaded", onReady);
  else onReady();
</script>

<style>
  .under-hero-tiles {
    background: #000 !important;
    color: #f7f7f7;
    padding: clamp(2.5rem, 6vw, 4.5rem) var(--content-pad) clamp(3rem, 8vw, 5rem);
    margin: 0;
    overflow-x: clip; /* verhindert 1px Scroll durch 100vw */
  }

  .tiles-shell {
    max-width: min(1400px, 94vw);
    margin: 0 auto;
    display: grid;
    gap: clamp(1.5rem, 3vw, 2.25rem);
  }

  /* ---------- INTRO / H2 (unverändert) ---------- */
  .tile--intro { border: none; background: transparent; padding: 0; }

  .tile--intro .intro {
    display: grid;
    grid-template-columns: clamp(240px, 20vw, 320px) 1px minmax(0, 1fr);
    column-gap: clamp(1.25rem, 3vw, 3rem);
    align-items: center;
    width: 100%;
  }

  .tile--intro .intro__icon {
    justify-self: end;
    display: grid;
    place-items: center end;
    color: rgba(211, 139, 69, 0.95);
  }

  .tile--intro .intro__svg {
    width: min(260px, 100%);
    height: auto;
    display: block;
  }

  .tile--intro .intro__sep {
    align-self: stretch;
    background: rgba(211, 139, 69, 0.75);
  }

  .tile--intro .intro__copy { width: 100%; max-width: none !important; min-width: 0; }

  .tile--intro .intro__copy h2 {
    margin: 0;
    color: #fff;
    text-transform: uppercase;
  }

  .tile--intro .intro__copy .h2-accent { color: rgba(211, 139, 69, 0.95); }
  .tile--intro .intro__copy .h2-line1 { white-space: nowrap; }

  .under-hero-tiles .tile--intro .intro__copy .intro__paragraph {
    margin: 1rem 0 0 !important;
    padding: 0 !important;
    width: 100% !important;
    max-width: none !important;
    max-inline-size: none !important;
    justify-self: stretch !important;
    color: rgba(247, 247, 247, 0.8);
    line-height: 1.7;
    font-weight: 300;
  }

  /* ---------- 2×2 Quadrate full-bleed ---------- */
  .wide-rows {
    /* echtes full-bleed: ignoriert Containerbreite und content pad */
    width: 100vw;
    margin-left: calc(50% - 50vw);
    margin-right: calc(50% - 50vw);
    background: #000;
  }

  .wide-row {
    display: grid;
    grid-template-columns: 1fr;
    gap: 0;              /* ✅ kein Spalt */
    background: #000;    /* ✅ falls rounding, bleibt schwarz */
    align-items: stretch;
  }

  @media (min-width: 900px) {
    .wide-row { grid-template-columns: 1fr 1fr; }
  }

  .panel {
    background: #000 !important;
    border: 0 !important;
    outline: 0 !important;
    box-shadow: none !important;
    border-radius: 0 !important;
    overflow: hidden;
    position: relative;

    min-height: var(--tile-height);
    height: var(--tile-height);
  }

  .panel--text {
    display: grid;
    align-items: center;
    min-height: var(--tile-height);
    height: var(--tile-height);
    padding: clamp(1.25rem, 3vw, 2.25rem);
    padding-top: var(--tile-pad-y);
    padding-bottom: var(--tile-pad-y);
  }

  .panel--slider {
    min-height: var(--tile-media-height);
    height: var(--tile-media-height);
  }

  .panel-inner { max-width: 74ch; display: grid; gap: 0.9rem; }

  .panel-title {
    margin: 0;
    text-transform: uppercase;
    font-size: clamp(1.6rem, 2.4vw, 2.6rem);
    line-height: 1.05;
    color: #fff;
  }
.panel-title.display-size-h1 {
  font-size: clamp(2.25rem, 4.4vw, 3.25rem);
}

  .accent { color: rgba(211, 139, 69, 0.95); }
  .panel-sep { height: 1px; background: rgba(211, 139, 69, 0.75); width: 100%; }

  .panel-text {
    margin: 0;
    color: rgba(247, 247, 247, 0.82);
    line-height: 1.7;
    font-weight: 300;
    font-family: "Inter", system-ui, sans-serif;
  }

  .panel-cta {
    display: inline-flex;
    justify-content: center;
    align-items: center;
    text-decoration: none;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    font-size: 0.95rem;
    padding: 0.95rem 1.1rem;
    border: 1px solid rgba(211, 139, 69, 0.6);
    color: rgba(211, 139, 69, 0.95);
    background: transparent;
    width: min(520px, 100%);
  }

  .panel-cta:hover,
  .panel-cta:focus-visible {
    outline: none;
    background: rgba(211, 139, 69, 0.14);
    border-color: rgba(211, 139, 69, 0.9);
  }

  /* ---------- Slider (ohne Ränder / ohne Masken) ---------- */
  :global([data-uh-tiles] .slider) {
    position: relative;
    width: 100%;
    height: 100%;
    background: #000;
    overflow: hidden;
  }

  :global([data-uh-tiles] .slider-track) {
    display: flex;
    width: 100%;
    height: 100%;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
    background: #000;
    overscroll-behavior-x: contain;
  }
  :global([data-uh-tiles] .slider-track::-webkit-scrollbar) { display: none; }

  :global([data-uh-tiles] .slide) {
    flex: 0 0 100%;
    width: 100%;
    height: 100%;
    scroll-snap-align: start;
    position: relative;
    overflow: hidden;
    background: #000;
  }

  /* ✅ Bild füllt komplett + Parallax mit leichter Overscan via scale */
  :global([data-uh-tiles] .slide > .parallax-img) {
    position: absolute !important;
    inset: 0 !important;
    width: 100% !important;
    height: 100% !important;
    object-fit: cover !important;
    object-position: center;
    display: block !important;

    transform: translate3d(0, var(--parallaxY, 0px), 0) scale(1.08);
    will-change: transform;
    backface-visibility: hidden;
  }

  /* Buttons – ohne Borders/Outlines, kein Rand */
  :global([data-uh-tiles] .slider-btn) {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 44px;
    height: 44px;
    border-radius: 999px;

    -webkit-appearance: none !important;
    appearance: none !important;
    border: 0 !important;
    outline: 0 !important;
    box-shadow: none !important;

    background: rgba(0,0,0,0.55) !important;
    color: #fff;

    padding: 0 !important;
    margin: 0 !important;

    display: grid;
    place-items: center;
    cursor: pointer;
    z-index: 6;
  }

  :global([data-uh-tiles] .slider-btn:hover),
  :global([data-uh-tiles] .slider-btn:focus),
  :global([data-uh-tiles] .slider-btn:focus-visible) {
    background: rgba(211, 139, 69, 0.92) !important;
    outline: none !important;
  }

  :global([data-uh-tiles] .slider-btn.prev) { left: 14px; }
  :global([data-uh-tiles] .slider-btn.next) { right: 14px; }

  @media (max-width: 720px) {
    :global([data-uh-tiles] .slider-btn) { display: none; }
  }

  @media (prefers-reduced-motion: reduce) {
    :global([data-uh-tiles] .slide > .parallax-img) {
      transform: none !important;
    }
  }
</style>
