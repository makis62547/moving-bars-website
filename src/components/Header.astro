---
const navLinks = [
  { href: "/cocktail-catering", label: "Cocktail Catering" },
  { href: "/mobile-bar", label: "Mobile Bar" },
  { href: "/cocktail-show", label: "Cocktail Show" },
  { href: "/cocktailkurse", label: "Cocktailkurse" },
  { href: "/kaffeecatering", label: "Kaffee Catering" },
  { href: "/anfrage", label: "Anfrage" },
];
---

<header
  class="
    fixed top-0 left-0 right-0 z-50
    bg-[rgba(0,0,0,0.55)]
    h-[var(--header-h)]
    overflow-visible
  "
>
  <div class="site-container flex h-full items-center justify-between gap-6 overflow-visible">
    <!-- Logo -->
    <a
      href="/"
      class="
        relative
        flex h-full items-start
        shrink-0
        pt-[10px]
        overflow-visible
        whitespace-nowrap
      "
      aria-label="Startseite"
    >
      <img
        src="/images/logo-white.png"
        alt="moving bars logo"
        class="
          h-[140px] w-auto
          translate-y-[8px]
          select-none
          shrink-0
          object-contain
        "
      />
    </a>

    <!-- Navigation -->
    <nav
      class="
        hidden h-full flex-nowrap items-center justify-center
        gap-12
        text-sm md:text-base
        font-light
        lg:flex
      "
      aria-label="Hauptnavigation"
    >
      {navLinks.map((link) => (
        <a
          href={link.href}
          class="
            text-white
            whitespace-nowrap
            tracking-normal
            normal-case
            hover:text-[#D38B45]
            transition-colors
          "
        >
          {link.label}
        </a>
      ))}
    </nav>

    <!-- Mobile menu button -->
    <button
      type="button"
      class="
        inline-flex items-center gap-2
        rounded-md
        px-3 py-2
        text-sm font-medium
        text-white
        ring-offset-2 ring-offset-black
        transition-colors
        hover:text-[#D38B45]
        focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[#D38B45]
        lg:hidden
      "
      aria-label="MenÃ¼ umschalten"
      aria-expanded="false"
      aria-controls="mobile-nav"
      data-menu-button
    >
      <span class="uppercase tracking-wide">Menu</span>
      <span class="block h-5 w-6" aria-hidden="true">
        <span class="block h-[2px] w-full bg-white"></span>
        <span class="mt-1 block h-[2px] w-full bg-white"></span>
        <span class="mt-1 block h-[2px] w-full bg-white"></span>
      </span>
    </button>
  </div>

  <!-- Mobile navigation overlay -->
  <div id="mobile-nav" class="mobile-nav" data-menu-panel>
    <div class="mobile-nav-backdrop" data-menu-backdrop aria-hidden="true"></div>
    <div class="mobile-nav-panel">
      <div class="site-container">
        <nav class="mobile-nav-links" aria-label="Hauptnavigation mobil">
          {navLinks.map((link) => (
            <a
              href={link.href}
              class="
                text-white
                py-2
                text-base
                font-light
                tracking-normal
                normal-case
                hover:text-[#D38B45]
                transition-colors
              "
            >
              {link.label}
            </a>
          ))}
        </nav>
      </div>
    </div>
  </div>
</header>

<script>
  const header = document.querySelector("header");
  const button = header?.querySelector("[data-menu-button]");
  const panel = header?.querySelector("[data-menu-panel]");
  const backdrop = header?.querySelector("[data-menu-backdrop]");
  const links = Array.from(panel?.querySelectorAll("a") ?? []);

  if (header && button && panel) {
    const closeMenu = () => {
      header.classList.remove("is-open");
      button.setAttribute("aria-expanded", "false");
    };

    const openMenu = () => {
      header.classList.add("is-open");
      button.setAttribute("aria-expanded", "true");
    };

    const toggleMenu = () => {
      if (header.classList.contains("is-open")) {
        closeMenu();
      } else {
        openMenu();
      }
    };

    button.addEventListener("click", toggleMenu);
    backdrop?.addEventListener("click", closeMenu);
    links.forEach((link) => link.addEventListener("click", closeMenu));

    const handleKey = (event) => {
      if (event.key === "Escape") {
        closeMenu();
      }
    };

    document.addEventListener("keydown", handleKey);

    const handleClickOutside = (event) => {
      const target = event.target;
      if (!panel.contains(target) && !button.contains(target)) {
        closeMenu();
      }
    };

    document.addEventListener("click", handleClickOutside);

    window.addEventListener("resize", () => {
      if (window.innerWidth >= 1024) {
        closeMenu();
      }
    });
  }
</script>

<style>
  .mobile-nav {
    display: none;
  }

  :global(header.is-open) .mobile-nav {
    display: block;
  }

  .mobile-nav-backdrop {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.65);
    backdrop-filter: blur(2px);
    z-index: 45;
  }

  .mobile-nav-panel {
    position: fixed;
    top: var(--header-h);
    left: 0;
    right: 0;
    max-height: calc(100vh - var(--header-h));
    overflow-y: auto;
    background: rgba(0, 0, 0, 0.95);
    border-top: 1px solid rgba(211, 139, 69, 0.35);
    padding: 1.25rem 0 2rem;
    z-index: 50;
  }

  .mobile-nav-links {
    display: flex;
    flex-direction: column;
    gap: 0.35rem;
  }

  .mobile-nav-links a {
    width: 100%;
  }

  @media (min-width: 1024px) {
    .mobile-nav {
      display: none !important;
    }
  }
</style>
