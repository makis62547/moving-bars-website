---
import "../styles/globals.css";
---

<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Montserrat:wght@400;500;700;800;900&display=swap"
      rel="stylesheet"
    />

    <title>Moving Bars · Mobile Cocktailbar & Catering Berlin</title>
    <meta
      name="description"
      content="Mobile Cocktailbars, Premium-Barkeeper und Full-Service-Catering für Events in Berlin und deutschlandweit."
    />

    <slot name="head" />
  </head>

  <body class="bg-black text-white antialiased min-h-screen">
    <slot />
    <script is:inline type="module">
      const layers = document.querySelectorAll('[data-parallax="bg"]');

      console.log("[parallax] layers:", layers.length);

      if (layers.length === 0) {
        console.warn("[parallax] no layers found");
        return;
      }

      const motionReduce = window.matchMedia("(prefers-reduced-motion: reduce)");
      if (motionReduce.matches) return;

      let ticking = false;

      const update = () => {
        ticking = false;
        const scrollY = window.scrollY;

        layers.forEach((layer) => {
          const speedRaw = Number.parseFloat(layer.dataset.parallaxSpeed || "");
          const speed = Number.isFinite(speedRaw) ? speedRaw : 0.25;
          const y = scrollY * speed;
          layer.style.setProperty("--py", `${y}px`);
        });
      };

      const requestTick = () => {
        if (!ticking) {
          ticking = true;
          window.requestAnimationFrame(update);
        }
      };

      window.addEventListener("scroll", requestTick, { passive: true });
      window.addEventListener("resize", requestTick, { passive: true });

      requestTick();
    </script>
  </body>
</html>
