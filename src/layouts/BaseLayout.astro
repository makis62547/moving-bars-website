---
import "../styles/globals.css";
---

<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Montserrat:wght@200;300;400;500;700;800;900&display=swap"
      rel="stylesheet"
    />

    <style is:global>
      :root {
        --accent: #e07501;
        --accent-rgb: 224, 117, 1;
        --accent-light: rgba(var(--accent-rgb), 0.7);
        --heading-line-height: 1.3;
        --text-max-width: 72ch;
        --text-block-gap: 1.6rem;
        --intro-panel-min: 440px;
        --intro-icon-size: clamp(140px, 18vw, 350px);
        --intro-icon-offset-y: 0px;
        --intro-divider-height: 110%;
        --intro-divider-offset-y: 0px;
        --intro-divider-offset-x: -65px;

        --bg-color: #050505;
        --text-color: #ffffff;
        --heading-color: #ffffff;
        --text-muted-color: #a7a7a7;

        /* Typografie-System */
        --body-font-family: "Montserrat", system-ui, sans-serif;
        --body-font-size: 18px;
        --body-line-height: 1.8;
        --body-font-weight: 500;

        --heading-font-family: "Montserrat", system-ui, sans-serif;
        --heading-font-weight: 300;
        --heading-letter-spacing: 0em;

        /* Tile / Slider Height System */
        --tile-height: 800px;          /* Standardhöhe aller Kacheln */
        --tile-pad-y: 24px;            /* Vertikales Padding in Textkacheln */
        --tile-media-height: var(--tile-height);

        /* Icon Positionssteuerung */
        --intro-icon-offset-x: -20px;
        --intro-icon-offset-y: -50px;
        --intro-icon-align: center;

        --intro-text-width: 90ch;
        --section-text-width: 90ch;
        --tile-text-width: 74ch;
        --paragraph-text-width: 72ch;

        --under-hero-pad-block: clamp(8rem, 8vw, 8rem);
      }
      @import "/src/design/typography.css" layer(design);
      @import "/src/design/spacing.css" layer(design);
      @import "/src/design/layout.css" layer(design);
    </style>

    <title>Moving Bars · Mobile Cocktailbar & Catering Berlin</title>
    <meta
      name="description"
      content="Mobile Cocktailbars, Premium-Barkeeper und Full-Service-Catering für Events in Berlin und deutschlandweit."
    />

    <slot name="head" />
  </head>

  <body class="antialiased min-h-screen">
    <slot />
    <script is:inline type="module">
      (() => {
        const layers = document.querySelectorAll('[data-parallax="bg"]');
        console.log("[parallax] layers:", layers.length);

        if (layers.length === 0) {
          console.warn("[parallax] no layers found");
          return;
        }

        const motionReduce = window.matchMedia("(prefers-reduced-motion: reduce)");
        if (motionReduce.matches) {
          console.log("[parallax] reduced-motion ON → disabled");
          return;
        }

        let ticking = false;

        const getScrollY = () =>
          window.scrollY ??
          document.scrollingElement?.scrollTop ??
          document.documentElement.scrollTop ??
          document.body.scrollTop ??
          0;

        const update = () => {
          ticking = false;
          const scrollY = getScrollY();

          layers.forEach((layer) => {
            const speedRaw = Number.parseFloat(layer.dataset.parallaxSpeed || "");
            const speed = Number.isFinite(speedRaw) ? speedRaw : 0.25;
            layer.style.setProperty("--py", `${scrollY * speed}px`);
          });
        };

        const requestTick = () => {
          if (!ticking) {
            ticking = true;
            requestAnimationFrame(update);
          }
        };

        window.addEventListener("scroll", requestTick, { passive: true });
        window.addEventListener("resize", requestTick, { passive: true });

        requestTick();
      })();
    </script>
  </body>
</html>
